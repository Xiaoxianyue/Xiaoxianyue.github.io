---
title: Delegates and Event
icon: alias
date: 2024-5-06 16:50:33
author: XiaoXianYue
isOriginal: true
category: 
    - C#
    - 大二下
tag:
    - C#
    - 大二下
sticky: false
star: false
article: true
timeline: true
image: false
navbar: true
sidebarIcon: true
headerDepth: 5
lastUpdated: true
editLink: false
backToTop: true
toc: true
---

## 1. Delegate 简介

- 回调函数是程序指定并以某种方式 "注册 "的函数，然后被另一个程序调用 -
- C/C++ 我们可以通过函数指针实现回调函数 

- C# -我们可以将方法引用封装在委托中 
- 在 C# 中，委托被视为一种引用类型，与类类型类似 
- 操作符 new 用于创建委托的新实例 
- 委托是对类中方法的安全引用类型

### 1.1 使用委托 

- 委托是 C# 程序中管理事件的重要部分 
- 事件是指发生的、我们的程序可能需要响应的事情 - 例如：人们按下用户界面上的按钮、时钟滴答作响以及信息通过网络到达 
- 在每种情况下，我们都需要告诉系统在事件发生时该怎么做

### 1.2 类型安全的委托 

- 类型安全这一短语在这里的意思是，如果方法接受两个整数参数并返回一个字符串，那么该方法的委托将具有完全相同的外观，并且不能以任何其他方式使用。

- 使用这个词是为了将委托与指针之类的东西区分开来，指针在 C 语言等更原始的语言中使用。

- C/C++ - 可以创建指向方法的指针，但 C 语言环境不知道方法的真实面貌

### 1.3 声明委托 

- 在 C# 中，我们使用关键字 delegate 和封装方法的签名来声明委托 
- 一些命名约定建议使用以 "Callback "结尾的委托名称 -
- 一些书籍没有使用这些约定

```c#
public delegate void NotifyCallback(decimal balance);
```

### 1.4 使用委托（在银行示例中......） 

- 考虑 "银行 "示例中的费用计算 - 银行将有许多不同的方法来进行计算，这取决于客户的类型和客户的状态 

- 它可能希望有一种方法，可以让程序在运行时选择使用哪种费用计算方法 

    ```c#
    public delegate decimal CalculateFee(decimal balance); 
    ```

    

- 这个委托可以代替接受一个十进制参数并返回一个十进制值的方法。

### 1.5 合理使用委托 

- 让程序在运行过程中改变自己的操作是一件相当奇怪的事情 -
- 所介绍的示例演示了委托是如何让程序将方法引用作为对象来操作的，而不是一种编写程序的好方法 -
- 委托经常用于事件处理程序，也用于管理线程

### 1.6 声明位置 

- 调用委托与调用方法类似。
- -但是，委托并不一定只指向与委托变量定义在同一个类中的方法。 它也可以是其他类和结构中的方法

- -如果我们在顶层程序（默认情况下在 Program.cs 中表示）中定义了委托，那么和其他类型一样，委托也是在代码末尾（或顶层之前）定义的。

- 但原则上，委托可以在一个类中定义



## 2. 实现一个委托

